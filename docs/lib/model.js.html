<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width" charset="utf-8"><title>neoprene</title><!-- Foundation CSS--><link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.1.6/css/foundation.min.css"><!-- Prism CSS--><style type="text/css">/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', monospace;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0,0%,100%,.5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}


.token.regex,
.token.important {
	color: #e90;
}

.token.important {
	font-weight: bold;
}

.token.entity {
	cursor: help;
}
</style><!-- Custom Styles--><style type="text/css">h1.page-title small {
  font-weight: 400;
}
/*.section-container, .section-container .section .title
  border-color #e6e6e6*/
#nav .section.active {
  padding-top: 0 !important;
}
#nav .section.active .title {
  background: #ddd;
}
#nav .section .title {
  background-color: #eee;
}
#nav .section .title a {
  font-weight: 700;
  padding: 0.6em;
}
#nav .section .title a small {
  font-size: 0.8em;
  line-height: 1em;
  display: block;
  color: #888;
  margin: 2px 0 -2px;
}
#nav .section .title:hover {
  background: #ddd;
}
code {
  background: transparent;
  line-height: 1.3em;
}
.comment {
  position: relative;
  padding-bottom: 1.5em;
  margin-bottom: 2em;
  border-bottom: 1px solid #ddd;
}
.comment ol,
.comment ul {
  margin-left: 2.25em;
}
.comment ol.no-bullet,
.comment ul.no-bullet {
  margin-left: 0;
}
.comment header {
  margin-bottom: 1.5em;
}
.comment header h1 {
  font-size: 2rem;
  margin-bottom: 0.2em;
}
.comment .section-container,
.comment .section-container > .section > .content {
  border: none;
}
.comment .section-container > .section > .title {
  padding: auto;
  background: none !important;
  border: none !important;
}
.comment .section-container > .section > .title a {
  border-radius: 4px;
  font-weight: 700;
  padding: 1px 10px 1px 0;
  margin-right: 5px;
  color: #ccc;
}
.comment .section-container > .section:hover .title a {
  color: #999;
}
.comment .section-container > .section.active .title a {
  color: #2ba6cb;
}
.comment .section-container > .section > .content {
  padding: 0.9em 0 0;
}
.comment div.description h2 {
  font-size: 1.2em;
}
.comment .tags span {
  margin-right: 4px;
}
.comment .tags .name,
.comment .tags .type {
  font-weight: 700;
}
.comment .tags .types {
  color: #666;
}
.comment .tags .description {
  margin-left: 15px;
}
.ctx-type {
  margin-right: 6px;
  font-size: 0.7em;
}
</style><script srr="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.1.6/js/vendor/custom.modernizr.js"></script></head><body><div class="row"><div class="small-12 columns"><h1 class="page-title">neoprene<small> lib/model.js</small></h1></div></div><div class="row"><div id="nav" class="large-3 columns"><div data-section="accordian" data-options="" class="section-container accordian"><div class="section"><p data-section-title class="title"><a href="../../docs/lib/graphObject.js.html"><small>lib/</small>graphObject.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/graphObject.js.html#set">set</a></li><li><a href="../../docs/lib/graphObject.js.html#get">get</a></li><li><a href="../../docs/lib/graphObject.js.html#markModified">markModified</a></li><li><a href="../../docs/lib/graphObject.js.html#modifiedPaths">modifiedPaths</a></li><li><a href="../../docs/lib/graphObject.js.html#isModified">isModified</a></li><li><a href="../../docs/lib/graphObject.js.html#isDirectModified">isDirectModified</a></li><li><a href="../../docs/lib/graphObject.js.html#isInit">isInit</a></li><li><a href="../../docs/lib/graphObject.js.html#isSelected">isSelected</a></li><li><a href="../../docs/lib/graphObject.js.html#validate">validate</a></li><li><a href="../../docs/lib/graphObject.js.html#invalidate">invalidate</a></li><li><a href="../../docs/lib/graphObject.js.html#validateUniqueIndexes">validateUniqueIndexes</a></li><li><a href="../../docs/lib/graphObject.js.html#toObject">toObject</a></li><li><a href="../../docs/lib/graphObject.js.html#toJSON">toJSON</a></li><li><a href="../../docs/lib/graphObject.js.html#inspect">inspect</a></li><li><a href="../../docs/lib/graphObject.js.html#toString">toString</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/index.js.html"><small>lib/</small>index.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/index.js.html#Neoprene">Neoprene</a></li><li><a href="../../docs/lib/index.js.html#connect">connect</a></li><li><a href="../../docs/lib/index.js.html#model">model</a></li><li><a href="../../docs/lib/index.js.html#version">version</a></li><li><a href="../../docs/lib/index.js.html#Schema">Schema</a></li><li><a href="../../docs/lib/index.js.html#loadModel">loadModel</a></li><li><a href="../../docs/lib/index.js.html#query">query</a></li><li><a href="../../docs/lib/index.js.html#findRelationshipById">findRelationshipById</a></li></ul></div></div><div class="section active"><p data-section-title class="title"><a href="../../docs/lib/model.js.html"><small>lib/</small>model.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/model.js.html#Model">Model</a></li><li><a href="../../docs/lib/model.js.html#ensureIndexes">ensureIndexes</a></li><li><a href="../../docs/lib/model.js.html#createRelationshipTo">createRelationshipTo</a></li><li><a href="../../docs/lib/model.js.html#createRelationshipFrom">createRelationshipFrom</a></li><li><a href="../../docs/lib/model.js.html#getAllRelationships">getAllRelationships</a></li><li><a href="../../docs/lib/model.js.html#getOutgoingRelationships">getOutgoingRelationships</a></li><li><a href="../../docs/lib/model.js.html#getIncomingRelationships">getIncomingRelationships</a></li><li><a href="../../docs/lib/model.js.html#getAdjacentNodes">getAdjacentNodes</a></li><li><a href="../../docs/lib/model.js.html#traverse">traverse</a></li><li><a href="../../docs/lib/model.js.html#find">find</a></li><li><a href="../../docs/lib/model.js.html#findOne">findOne</a></li><li><a href="../../docs/lib/model.js.html#findById">findById</a></li><li><a href="../../docs/lib/model.js.html#findOneAndUpdate">findOneAndUpdate</a></li><li><a href="../../docs/lib/model.js.html#findOneAndRemove">findOneAndRemove</a></li><li><a href="../../docs/lib/model.js.html#findByIdAndUpdate">findByIdAndUpdate</a></li><li><a href="../../docs/lib/model.js.html#findByIdAndRemove">findByIdAndRemove</a></li><li><a href="../../docs/lib/model.js.html#getIndexedNode">getIndexedNode</a></li><li><a href="../../docs/lib/model.js.html#query">query</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/path.js.html"><small>lib/</small>path.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/path.js.html#Path">Path</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/array.js.html"><small>lib/schema/</small>array.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/array.js.html#SchemaArray">SchemaArray</a></li><li><a href="../../docs/lib/schema/array.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/array.js.html#applyGetters">applyGetters</a></li><li><a href="../../docs/lib/schema/array.js.html#cast">cast</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/boolean.js.html"><small>lib/schema/</small>boolean.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/boolean.js.html#SchemaBoolean">SchemaBoolean</a></li><li><a href="../../docs/lib/schema/boolean.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/boolean.js.html#cast">cast</a></li><li><a href="../../docs/lib/schema/boolean.js.html#castForQuery">castForQuery</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/date.js.html"><small>lib/schema/</small>date.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/date.js.html#SchemaDate">SchemaDate</a></li><li><a href="../../docs/lib/schema/date.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/date.js.html#cast">cast</a></li><li><a href="../../docs/lib/schema/date.js.html#castForQuery">castForQuery</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/index.js.html"><small>lib/schema/</small>index.js</a></p><div data-section-content class="content"><ul class="side-nav"></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/mixed.js.html"><small>lib/schema/</small>mixed.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/mixed.js.html#Mixed">Mixed</a></li><li><a href="../../docs/lib/schema/mixed.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/mixed.js.html#cast">cast</a></li><li><a href="../../docs/lib/schema/mixed.js.html#castForQuery">castForQuery</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/number.js.html"><small>lib/schema/</small>number.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/number.js.html#SchemaNumber">SchemaNumber</a></li><li><a href="../../docs/lib/schema/number.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/number.js.html#min">min</a></li><li><a href="../../docs/lib/schema/number.js.html#max">max</a></li><li><a href="../../docs/lib/schema/number.js.html#cast">cast</a></li><li><a href="../../docs/lib/schema/number.js.html#castForQuery">castForQuery</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema/string.js.html"><small>lib/schema/</small>string.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema/string.js.html#SchemaString">SchemaString</a></li><li><a href="../../docs/lib/schema/string.js.html#enum">enum</a></li><li><a href="../../docs/lib/schema/string.js.html#lowercase">lowercase</a></li><li><a href="../../docs/lib/schema/string.js.html#uppercase">uppercase</a></li><li><a href="../../docs/lib/schema/string.js.html#trim">trim</a></li><li><a href="../../docs/lib/schema/string.js.html#match">match</a></li><li><a href="../../docs/lib/schema/string.js.html#checkRequired">checkRequired</a></li><li><a href="../../docs/lib/schema/string.js.html#cast">cast</a></li><li><a href="../../docs/lib/schema/string.js.html#castForQuery">castForQuery</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schema.js.html"><small>lib/</small>schema.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schema.js.html#Schema">Schema</a></li><li><a href="../../docs/lib/schema.js.html#add">add</a></li><li><a href="../../docs/lib/schema.js.html#reserved">reserved</a></li><li><a href="../../docs/lib/schema.js.html#path">path</a></li><li><a href="../../docs/lib/schema.js.html#interpretAsType">interpretAsType</a></li><li><a href="../../docs/lib/schema.js.html#eachPath">eachPath</a></li><li><a href="../../docs/lib/schema.js.html#requiredPaths">requiredPaths</a></li><li><a href="../../docs/lib/schema.js.html#pathType">pathType</a></li><li><a href="../../docs/lib/schema.js.html#queue">queue</a></li><li><a href="../../docs/lib/schema.js.html#pre">pre</a></li><li><a href="../../docs/lib/schema.js.html#post">post</a></li><li><a href="../../docs/lib/schema.js.html#plugin">plugin</a></li><li><a href="../../docs/lib/schema.js.html#method">method</a></li><li><a href="../../docs/lib/schema.js.html#static">static</a></li><li><a href="../../docs/lib/schema.js.html#index">index</a></li><li><a href="../../docs/lib/schema.js.html#set">set</a></li><li><a href="../../docs/lib/schema.js.html#indexes">indexes</a></li><li><a href="../../docs/lib/schema.js.html#virtual">virtual</a></li><li><a href="../../docs/lib/schema.js.html#virtualpath">virtualpath</a></li><li><a href="../../docs/lib/schema.js.html#Types">Types</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/schematype.js.html"><small>lib/</small>schematype.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/schematype.js.html#SchemaType">SchemaType</a></li><li><a href="../../docs/lib/schematype.js.html#default">default</a></li><li><a href="../../docs/lib/schematype.js.html#index">index</a></li><li><a href="../../docs/lib/schematype.js.html#unique">unique</a></li><li><a href="../../docs/lib/schematype.js.html#set">set</a></li><li><a href="../../docs/lib/schematype.js.html#get">get</a></li><li><a href="../../docs/lib/schematype.js.html#validate">validate</a></li><li><a href="../../docs/lib/schematype.js.html#required">required</a></li><li><a href="../../docs/lib/schematype.js.html#getDefault">getDefault</a></li><li><a href="../../docs/lib/schematype.js.html#applySetters">applySetters</a></li><li><a href="../../docs/lib/schematype.js.html#applyGetters">applyGetters</a></li><li><a href="../../docs/lib/schematype.js.html#doValidate">doValidate</a></li><li><a href="../../docs/lib/schematype.js.html#_isRef">_isRef</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/statemachine.js.html"><small>lib/</small>statemachine.js</a></p><div data-section-content class="content"><ul class="side-nav"></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/types/array.js.html"><small>lib/types/</small>array.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/types/array.js.html#NeopreneArray">NeopreneArray</a></li><li><a href="../../docs/lib/types/array.js.html#_cast">_cast</a></li><li><a href="../../docs/lib/types/array.js.html#_markModified">_markModified</a></li><li><a href="../../docs/lib/types/array.js.html#_registerAtomic">_registerAtomic</a></li><li><a href="../../docs/lib/types/array.js.html#hasAtomics">hasAtomics</a></li><li><a href="../../docs/lib/types/array.js.html#push">push</a></li><li><a href="../../docs/lib/types/array.js.html#nonAtomicPush">nonAtomicPush</a></li><li><a href="../../docs/lib/types/array.js.html#pop">pop</a></li><li><a href="../../docs/lib/types/array.js.html#shift">shift</a></li><li><a href="../../docs/lib/types/array.js.html#remove">remove</a></li><li><a href="../../docs/lib/types/array.js.html#pull">pull</a></li><li><a href="../../docs/lib/types/array.js.html#splice">splice</a></li><li><a href="../../docs/lib/types/array.js.html#unshift">unshift</a></li><li><a href="../../docs/lib/types/array.js.html#sort">sort</a></li><li><a href="../../docs/lib/types/array.js.html#addToSet">addToSet</a></li><li><a href="../../docs/lib/types/array.js.html#toObject">toObject</a></li><li><a href="../../docs/lib/types/array.js.html#inspect">inspect</a></li><li><a href="../../docs/lib/types/array.js.html#indexOf">indexOf</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/utils.js.html"><small>lib/</small>utils.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/utils.js.html#args">args</a></li><li><a href="../../docs/lib/utils.js.html#clone">clone</a></li><li><a href="../../docs/lib/utils.js.html#isNeopreneObject">isNeopreneObject</a></li><li><a href="../../docs/lib/utils.js.html#deepEqual">deepEqual</a></li><li><a href="../../docs/lib/utils.js.html#options">options</a></li><li><a href="../../docs/lib/utils.js.html#tick">tick</a></li></ul></div></div><div class="section"><p data-section-title class="title"><a href="../../docs/lib/virtualtype.js.html"><small>lib/</small>virtualtype.js</a></p><div data-section-content class="content"><ul class="side-nav"><li><a href="../../docs/lib/virtualtype.js.html#VirtualType">VirtualType</a></li><li><a href="../../docs/lib/virtualtype.js.html#get">get</a></li><li><a href="../../docs/lib/virtualtype.js.html#set">set</a></li><li><a href="../../docs/lib/virtualtype.js.html#applyGetters">applyGetters</a></li><li><a href="../../docs/lib/virtualtype.js.html#applySetters">applySetters</a></li></ul></div></div></div></div><div class="small-12 large-9 columns"><article class="comment"><header><h1 id="Model">Model</h1><h5 class="subheader"><div class="label radius ctx-type">function</div>Model()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">doc</span><span class="description">values to with which to create the document</span></li><li class="tag"><span class="type">@inherits: </span><span class="string">GraphObject</span></li><li class="tag"><span class="type">@event: </span><span class="string">`error`: If listening to this Model event, it is emitted when a document was saved without passing a callback and an `error` occurred. If not listening, the event bubbles to the connection used to create this Model.</span></li><li class="tag"><span class="type">@event: </span><span class="string">`index`: Emitted after `Model#ensureIndexes` completes. If an error occurred it is passed with the event.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Model constructor</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">function Model (doc, fields) {
  GraphObject.call(this, doc, fields);
}</code></pre></div></div></div></article><article class="comment"><header></header><ul class="no-bullet tags"><li class="tag"><span class="type">@property: </span><span class="string">url</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Connection the model uses.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.db;</code></pre></div></div></div></article><article class="comment"><header></header><ul class="no-bullet tags"><li class="tag"><span class="type">@property: </span><span class="string">modelName</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>The name of the model</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.modelName;</code></pre></div></div></div></article><article class="comment"><header></header><ul class="no-bullet tags"><li class="tag"><span class="type">@property: </span><span class="string">objectType</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>The type of the model</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.objectType;</code></pre></div></div></div></article><article class="comment"><header><h1 id="ensureIndexes">ensureIndexes</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.ensureIndexes()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">[cb]</span><span class="description">optional callback</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Sends <code>ensureIndex</code> commands to mongo for each index declared in the schema.</p>

<h4>Example:</h4>

<pre><code>Event.ensureIndexes(function (err) {
  if (err) return handleError(err);
});
</code></pre>

<p>After completion, an <code>index</code> event is emitted on this <code>Model</code> passing an error if one occurred.</p>

<h4>Example:</h4>

<pre><code>var eventSchema = new Schema({ thing: { type: 'string', unique: true }})
var Event = mongoose.model('Event', eventSchema);

Event.on('index', function (err) {
  if (err) console.error(err); // error occurred during index creation
})
</code></pre>

<p><em>NOTE: It is not recommended that you run this in production. Index creation may impact database performance depending on your load. Use with caution.</em></p>

<p>The <code>ensureIndex</code> commands are not sent in parallel. This is to avoid the <code>MongoError: cannot add index with a background operation in progress</code> error. See <a href="https://github.com/LearnBoost/mongoose/issues/1365">this ticket</a> for more information.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.ensureIndexes = function ensureIndexes (cb) {
  var indexes = this.schema.indexes();
  if (!indexes.length) {
    return cb &amp;&amp; process.nextTick(cb);
  }

  // Indexes are created one-by-one to support how MongoDB &lt; 2.4 deals
  // with background indexes.

  var self = this
    , safe = self.schema.options.safe;

  function done (err) {
    // self.emit('index', err);
    cb &amp;&amp; cb(err);
  }

  function create () {
    var index = indexes.shift();
    if (!index) return done();
    var options = index[1];

    var property_key;
    for(var key in index[0]){
      property_key = key;
    }

    self.prototype.index(property_key, options.required, function(err){
      if(err &amp;&amp; err.message.indexOf('already indexed') === -1){
        return done(err);
      }
      create();
    });
  }

  create();
}</code></pre></div></div></div></article><article class="comment"><header></header><ul class="no-bullet tags"><li class="tag"><span class="type">@property: </span><span class="string">schema</span></li><li class="tag"><span class="type">@receiver: </span><span class="string">Model</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Schema the model uses.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.schema;</code></pre></div></div></div></article><article class="comment"><header></header><ul class="no-bullet tags"><li class="tag"><span class="type">@property: </span><span class="string">db</span></li><li class="tag"><span class="type">@receiver: </span><span class="string">Model</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Database url the model uses.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.db;</code></pre></div></div></div></article><article class="comment"><header><h1 id="createRelationshipTo">createRelationshipTo</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.createRelationshipTo()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Model}</span><span class="name">otherModel</span><span class="description">The destination node.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">type</span><span class="description">The type of relationships e.g. friend.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">data</span><span class="description">Key-Value properties of relationship. Optional</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Relationship}</span><span class="description"></span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Create relationship with direction from node to otherModel with given<br />type and data properties.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.createRelationshipTo = function(otherModel, type, data, callback) {
  this._createRelationship(this, otherModel, type, data, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="createRelationshipFrom">createRelationshipFrom</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.createRelationshipFrom()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Model}</span><span class="name">otherModel</span><span class="description">The relationship origin node.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">type</span><span class="description">The type of relationships e.g. friend.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">data</span><span class="description">Key-Value properties of relationship. Optional</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Relationship}</span><span class="description"></span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Create relationship with direction to node from otherModel with given<br />type and data properties.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.createRelationshipFrom = function(otherModel, type, data, callback) {
  this._createRelationship(otherModel, this, type, data, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="getAllRelationships">getAllRelationships</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.getAllRelationships()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">type</span><span class="description">The type of relationship e.g. friend. Optional. Defaults to all types.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Array of Relationships or empty.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Get all relationships for a node with an optional type. Direction of<br />relationship is not relevant</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.getAllRelationships = function(type, callback) {
  return this._getRelationships('all', type, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="getOutgoingRelationships">getOutgoingRelationships</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.getOutgoingRelationships()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">type</span><span class="description">The type of relationship e.g. friend. Optional. Defaults to all types.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Array of Relationships or empty.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Get all outgoing relationships for a node with an optional type.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.getOutgoingRelationships = function(type, callback) {
  return this._getRelationships('out', type, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="getIncomingRelationships">getIncomingRelationships</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.getIncomingRelationships()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">type</span><span class="description">The type of relationship e.g. friend. Optional. Defaults to all types.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Array of Relationships or empty.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Get all incoming relationships for a node with an optional type.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.getIncomingRelationships = function(type, callback) {
  return this._getRelationships('in', type, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="getAdjacentNodes">getAdjacentNodes</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.getAdjacentNodes()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String,}</span><span class="name">Array&lt;String&gt;,</span><span class="description">Object, Array&lt;Object&gt;} rels</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Number}</span><span class="name">depth</span><span class="description">Optional. Defaults to 1.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Models or empty.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Return the Models with a relationship to the given node optionally<br />filtered by relationship types / direction to a specified depth<br />(number of levels)<br />Rels is very versatile. This can be a string type, e.g. <code>'likes'</code>, in<br />which case both directions are traversed. Or it can be an array of string<br />types, e.g. <code>['likes', 'loves']</code>. It can also be an object, e.g. <code>{type:<br />'likes', direction: 'out'}</code>. Finally, it can be an array of objects, e.g.<br /><code>[{type: 'likes', direction: 'out'}, ...]</code>. Optional. Defaults to all<br />directions and all types.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.getAdjacentNodes = function(rels, depth, callback) {
  // optional depth and rels inputs
  if (typeof(depth) === 'function') {
    callback = depth;
    depth = 1;
  }
  if (typeof(rels) === 'function') {
    callback = rels;
    rels = null;
    depth = 1;
  }
  this.traverse('node', null, rels, null, null, depth, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="traverse">traverse</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.prototype.traverse()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">returnType</span><span class="description">node, relationship, path, fullpath. Defaults to path.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">order</span><span class="description">breadth_first, depth_first. Defaults to breadth_first.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String,}</span><span class="name">Array,</span><span class="description">Object} relationships See description</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">uniqueness</span><span class="description">node_global, none, relationship_global, node_path, relationship_path. Defaults to node_global.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">returnFilter</span><span class="description">all, all_but_start_node. Defaults to all_but_start_node.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Number}</span><span class="name">maxDepth</span><span class="description">Number of levels. Defaults to 1.</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Array of Models and,or Relationships</span></li><li class="tag"><span class="type">@: </span><span class="string">Empty if no results returned.</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Custom traversal of the graph database.<br /><a href='http://docs.neo4j.org/chunked/stable/rest-api-traverse.html#rest-api-traversal-using-a-return-filter'>http://docs.neo4j.org/chunked/stable/rest-api-traverse.html#rest-api-traversal-using-a-return-filter</a></p>

<p>Relationships is very versatile. This can be a string type, e.g. <code>'likes'</code>, in<br />which case both directions are traversed. Or it can be an array of string<br />types, e.g. <code>['likes', 'loves']</code>. It can also be an object, e.g. <code>{type:<br />'likes', direction: 'out'}</code>. Finally, it can be an array of objects, e.g.<br /><code>[{type: 'likes', direction: 'out'}, ...]</code>. Optional. Defaults to all<br />directions and all types.</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.prototype.traverse = function (returnType, order, relationships, uniqueness, returnFilter, maxDepth, callback) {
  if(this.objectType !== 'node') return callback(new NeopreneError('Can only create relationships from nodes'))
  // validate that all values exist
  if (!callback || typeof(callback) !== 'function') {
    process.nextTick(function() {
      return callback(new NeopreneError('Traverse function incorrectly called'),
        null);
    });
  }
  else {
    var self = this;

    // list the possible options for each input type
    var returnTypes = ['node', 'relationship', 'path', 'fullpath']
      , orders = ['breadth_first', 'depth_first']
      , relationshipsOptions = ['all', 'in', 'out']
      , uniquenessOptions = ['node_global', 'none', 'relationship_global',
        'node_path', 'relationship_path']
      , returnFilters = ['all', 'all_but_start_node'];

    // map relationships to array of objects
    if (!relationships) {
      relationships = [];
      relationships.push({ direction: 'all' });
    }
    else {
      if (!(relationships instanceof Array)) {
        relationships = [relationships];
      }
      relationships = relationships.map(function(rel) {
        if (typeof(rel) === 'string') return { direction: 'all', type: rel };
        else return rel;
      });
    }

    // set defaults if values are blank
    if (!returnType) returnType = 'path';
    if (!order) order = 'breadth_first';

    if (!uniqueness) uniqueness = 'node_global';
    if (!returnFilter) returnFilter = 'all_but_start_node';
    if (!maxDepth) maxDepth = '1';

    // validate that options entered are valid options
    if (returnTypes.indexOf(returnType) === -1 ||
     orders.indexOf(order) === -1 ||
     uniquenessOptions.indexOf(uniqueness) === -1 ||
     returnFilters.indexOf(returnFilter) === -1 ||
     typeof(maxDepth) !== 'number') {
      var issue = '';
      if (returnTypes.indexOf(returnType) === -1) {
        if (issue.length &gt; 0) issue += ', ';
        issue += 'invalid returnType';
      }
      if (orders.indexOf(order) === -1) {
        if (issue.length &gt; 0) issue += ', ';
        issue += 'invalid order';
      }
      if (uniquenesss.indexOf(uniqueness) === -1) {
        if (issue.length &gt; 0) issue += ', ';
        issue += 'invalid uniqueness';
      }
      if (returnFilters.indexOf(returnFilter) === -1) {
        if (issue.length &gt; 0) issue += ', ';
        issue += 'invalid returnFilter';
      }
      if (typeof(maxDepth) !== 'number') {
        if (issue.length &gt; 0) issue += ', ';
        issue += 'invalid max depth';
      }
      process.nextTick(function() {
        return callback(new NeopreneError('Invalid traverse request ' + issue),
          null);
      });
    }
    else {
      var traverseURL = this.self + '/traverse/' + returnType;
      var jsonData = {
        order: order,
        relationships: relationships,
        uniqueness: uniqueness,
        return_filter: {
          'language' : 'builtin',
          'name' : returnFilter
        },
        max_depth: maxDepth
      };

      request
        .post(traverseURL)
        .send(jsonData)
        .set('Accept', 'application/json')
        .set('X-Stream', true)
        .end(function(res) {
          if (res.status !== 200) {
            // if (res.status === 404) {
            //   return callback(null, null);
            // }
            return callback(new NeopreneError('Traverse error: ' +
              res.status), null);
          }
          // map items returned to Models, Relationships or Paths
          async.map(res.body, function(data, callback) {
            return callback(null, utils.transform(data, self.base));
          }, function(err, results) {
            if (err) return callback(new NeopreneError(err));
            return callback(null, results);
          });
        });
    }
  }
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="find">find</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.find()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">conditions</span><span class="description">Object of fields and value</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">fields</span><span class="description">Space delimited string</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node}</span><span class="description">or Array} If you specify a limit of 1 a single node is returned, otherwise an array of nodes</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Generic find for your model<br />Conditions and callback are mandatory but fields and options are not</p>

<p>Examples:<br />User.find({first:'Rory'}, function(err, nodes){})</p>

<p>Fields will return object with only those fields<br />At present everything is being returned from the database so there is no performance benefit<br />This will be investigated in a later release<br />User.find({first:'Rory', last: 'Madden'}, 'first last gender', function(err, nodes){})</p>

<p>Options can include: limit, skip, using (to specify an index) or orderBy<br />limit: options = {limit: 10}<br />skip: options = {skip: 7}<br />using: options = {using: ['first, last']}  // can be a single value string or an array<br />orderBy: options = {orderBy: [{field: 'first', desc:true, nulls:true}]}<br />orderBy must be an array of objects - even if there is only one onject<br />each object in orderBy must contain a field element, desc and nulls are optional and default to false<br />User.find({first:'Rory'}, '', {limit: 5, skip:3, orderBy: [{first: 'last', desc:true, nulls: true}]}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.find = function(conditions, fields, options, callback){
  var self = this;

  if ('function' == typeof conditions) {
    callback = conditions;
    conditions = null;
    fields = null;
    options = null;
  } else if ('function' == typeof fields) {
    callback = fields;
    fields = null;
    options = null;
  } else if ('function' == typeof options) {
    callback = options;
    options = null;
  }

  // Todo: replace with query (mquery)
  if(conditions === null){
    return callback(new NeopreneError('Need to enter some conditions in your query'));
  }

  var remove = null;
  // is the intention to delete the node?
  if(options &amp;&amp; options.hasOwnProperty('remove')){
    remove = options.remove;
    delete options.remove;
  }

  var update = null;
  if(options &amp;&amp; options.hasOwnProperty('update')){
    update = options.update;
    delete options.update;
  }

  // build query
  var query = 'MATCH n:' + this.modelName;
  // if there are conditions add in the where clauses
  if(conditions){
    // if we are querying for an id we have to start our search differently
    if(conditions.hasOwnProperty('_id')){
      query = 'START n='+this.objectType+'('+conditions['_id']+')';
      // remove the condition so it doesn't get checked again
      delete conditions['_id'];
    }
    var params = {};
    // loop through all conditions and add a WHERE clause
    for(var key in conditions){
      query += ' WHERE n.' + key + ' = {' + key + '}';
      params[key] = conditions[key];
    }
  }

  // if we need to make updates set the values here
  if(update &amp;&amp; options &amp;&amp; options.limit === 1 &amp;&amp; !remove){
    // expected format update = { first: 'Rory', last: 'Madden'}
    for(var key in update){
      query += ' SET n.' + key + ' = {update' + key + '}';
      params['update' + key] = update[key];
    }
  }

  // return or delete the value (delete only for one record)
  if(remove &amp;&amp; options &amp;&amp; options.limit === 1) {
    if(remove.force) {
      query += ' MATCH n-[r?]-() DELETE r,n'
    }
    else query += ' DELETE n'
  }
  else query += ' RETURN n';

  //if there are options add in the options
  if(options &amp;&amp; !(remove &amp;&amp; options.limit === 1)){
    for(var option in options){
      // many options can be array of values orderBy, using
      switch(option) {
        case 'limit':
          // expected format options = { limit: 1 }
          query += ' LIMIT '+options[option];
          break;
        case 'orderBy':
          //expected format options = {orderBy: [{ field: 'name', nulls: true}, {field: 'gender', desc: true}] }
          // nulls and desc are optional
          var lenO = options[option].length;
          for(var k=0; k&lt;lenO; k++){
            if(options[option][k].field){
              query += ' ORDER BY n.' + options[option][k].field;
              if(options[option][k].nulls) query += '?';
              if(options[option][k].desc) query += ' DESC';
              query += ', ';
            }
          }
          // clean up comma at end
          if(query.substr(-2,2) === ', ') query = query.substr(0, query.length - 2);
          break;
        case 'skip':
          // expected format options = { skip: 1 }
          query += ' SKIP '+options[option];
          break;
        case 'using':
          //expected format options = {using: ['name', 'gender'] }
          if(typeof options[option] === 'array'){
            var lenO = options[option].length;
            for(var l=0; l&lt;lenO; l++){
              query += ' USING INDEX n:'+ this.modelName + '(' + options[option][l] + ')';
            }
          }
          else query += ' USING INDEX n:'+ this.modelName + '(' + options[option] + ')';
          break;
      }
    }
  }

  var cypherUrl = this.db + '/db/data/cypher';
  var cypherQuery = { query: query, params: params };

  request
    .post(cypherUrl)
    .send(cypherQuery)
    .set('Accept', 'application/json')
    .set('X-Stream', true)
    .end(function(res) {
      // REST API returns 200
      if (res.status === 200) {
        // loop through all nodes returned and load them as models
        var len = res.body.data.length;
        var results = [];
        for(var i=0; i &lt; len; i++){
          var node = utils.loadObject(res.body.data[i][0], self.base);
          // if fields have been specified reduce the fields available
          // TODO: to reduce strain on the database and post processing this should be done in the query
          //        difficulty loading multiple fields into an object though - investigate query object
          if(fields){
            var elements = fields.split(' ');
            for(var key in node._doc){
              if(elements.indexOf(key) === -1) delete node._doc[key];
            }
          }
          results.push(node);
        }
        // findOne, findById should return a single value
        if(options &amp;&amp; options.limit === 1) results = results[0];

        // if a value has been updated then increment version
        if(update &amp;&amp; options &amp;&amp; options.limit===1){
          if (results.__version) {
            var doIncrement = VERSION_INC === (VERSION_INC &amp; results.__version);
            results.__version = undefined;
            // increment version if was successful
            if (doIncrement) {
              var key = results.schema.options.versionKey;
              var version = results.getValue(key) | 0;
              results.setValue(key, version + 1);
            }
          }
        }
        return callback(null, results);
      }
      else return callback(new NeopreneError(res.body.message));
    });
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="findOne">findOne</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findOne()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">conditions</span><span class="description">Object of fields and value</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">fields</span><span class="description">Space delimited string</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Returns a single node which matches the conditions.<br />If multiple nodes match the first node will be returned<br />Conditions and callback are mandatory but fields and options are not</p>

<p>Examples:<br />User.findOne({first:'Rory'}, function(err, nodes){})</p>

<p>Fields will return object with only those fields<br />At present everything is being returned from the database so there is no performance benefit<br />This will be investigated in a later release<br />User.findOne({first:'Rory', last: 'Madden'}, 'first last gender', function(err, nodes){})</p>

<p>Options can include: skip, using (to specify an index) or orderBy<br />skip: options = {skip: 7}<br />using: options = {using: ['first, last']}  // can be a single value string or an array<br />orderBy: options = {orderBy: [{field: 'first', desc:true, nulls:true}]}<br />orderBy must be an array of objects - even if there is only one onject<br />each object in orderBy must contain a field element, desc and nulls are optional and default to false<br />User.findOne({first:'Rory'}, '', {skip:3, orderBy: [{first: 'last', desc:true, nulls: true}]}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findOne = function(conditions, fields, options, callback){
  if ('function' == typeof options) {
    callback = options;
    options = {};
  } else if ('function' == typeof fields) {
    callback = fields;
    fields = null;
    options = {};
  } else if ('function' == typeof conditions) {
    callback = conditions;
    conditions = {};
    fields = null;
    options = {};
  }

  // only want to return one item
  options.limit = 1;

  // pass to find
  return this.find(conditions, fields, options, callback);
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="findById">findById</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findById()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Number}</span><span class="name">id</span><span class="description">Id requested</span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">fields</span><span class="description">Space delimited string</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Returns a single node which matches the id.<br />If multiple nodes match the first node will be returned<br />Id and callback are mandatory but fields and options are not</p>

<p>Examples:<br />User.findById(20189, function(err, nodes){})</p>

<p>Fields will return object with only those fields<br />At present everything is being returned from the database so there is no performance benefit<br />This will be investigated in a later release<br />User.findById(20189, 'first last gender', function(err, nodes){})</p>

<p>Options dont make much sense with findById<br />but you can include: skip, using (to specify an index) or orderBy<br />skip: options = {skip: 7}<br />using: options = {using: ['first, last']}  // can be a single value string or an array<br />orderBy: options = {orderBy: [{field: 'first', desc:true, nulls:true}]}<br />orderBy must be an array of objects - even if there is only one onject<br />each object in orderBy must contain a field element, desc and nulls are optional and default to false<br />User.findById(20189, '', {skip:3, orderBy: [{first: 'last', desc:true, nulls: true}]}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findById = function(id, fields, options, callback) {
  if(typeof id ==='function'){
    callback = id;
    return callback(new NeopreneError('Need to include an id'));
  }
  return this.findOne({ _id: id }, fields, options, callback);
};</code></pre></div></div></div></article><article class="comment"><header><h1 id="findOneAndUpdate">findOneAndUpdate</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findOneAndUpdate()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">conditions</span><span class="description">Object of fields and value</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">update</span><span class="description">Object with fields and updates</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Updates and returns a single node which matches the conditions.<br />If multiple nodes match the first node will be returned and updated<br />Conditions, update and callback are mandatory but options is not</p>

<p>Examples:<br />User.findOneAndUpdate({first:'Rory'}, {first:'Other'}, function(err, nodes){})</p>

<p>Options can include: skip, using (to specify an index) or orderBy<br />skip: options = {skip: 7}<br />using: options = {using: ['first, last']}  // can be a single value string or an array<br />orderBy: options = {orderBy: [{field: 'first', desc:true, nulls:true}]}<br />orderBy must be an array of objects - even if there is only one onject<br />each object in orderBy must contain a field element, desc and nulls are optional and default to false<br />User.findOneAndUpdate({first:'Rory'}, {first:'Other'}, {skip:3, orderBy: [{first: 'last', desc:true, nulls: true}]}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findOneAndUpdate = function(conditions, update, options, callback){
  if(typeof options === 'function'){
    callback = options;
    options = {};
  }
  else if (arguments.length &lt; 3) {
    if ('function' == typeof conditions) {
      callback = conditions;
    }
    else if('function' === typeof update){
      callback = update;
    }
    return callback(new NeopreneError('Conditions, updates and callback are mandatory'))
  }
  options.update = update;
  this.findOne(conditions, '', options, callback);
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="findOneAndRemove">findOneAndRemove</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findOneAndRemove()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">conditions</span><span class="description">Object of fields and value</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">update</span><span class="description">Object with fields and updates</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Finds and removes a single node which matches the conditions.<br />Requires two database calls - one to find the id and the second to remove<br />If multiple nodes match the first node will be returned and removed<br />Conditions and callback are mandatory but options is not</p>

<p>Examples:<br />User.findOneAndRemove({first:'Rory'}, function(err, nodes){})</p>

<p>Options are used to force a delete. If a node has relationships you cannot delete it<br />Set options to force to remove all relationships as well<br />User.findOneAndRemove({first:'Rory'}, {remove: {force: true}}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findOneAndRemove = function(conditions, options, callback){
  var self = this;
  if (1 === arguments.length &amp;&amp; 'function' == typeof conditions) {
    callback = conditions;
    return callback(new NeopreneError('You need to enter conditions to find the node'))
  }
  if(typeof options === 'function'){
    callback = options;
    options = null;
  }

  if(!options) options = {};
  if(options &amp;&amp; options.remove){
    var temp = options.remove;
    delete options.remove
  }
  this.findOne(conditions, '', options, function(err, node){
    if(options &amp;&amp; temp) options.remove = temp;
    return self.findByIdAndRemove(node._id, options, callback)
  });
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="findByIdAndUpdate">findByIdAndUpdate</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findByIdAndUpdate()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">id</span><span class="description">Id of node/relationship</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">update</span><span class="description">Object with fields and updates</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Updates and returns a single node which matches the id.<br />If multiple nodes match the first node will be returned and updated<br />Conditions, update and callback are mandatory but options is not</p>

<p>Examples:<br />User.findByIdAndUpdate(20138, {first:'Other'}, function(err, nodes){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findByIdAndUpdate = function(id, update, options, callback){
  if(typeof options === ' function'){
    callback = options;
    options = {};
  }
  else if (arguments.length &lt; 3) {
    if ('function' == typeof id) {
      callback = id;
    }
    else if('function' === typeof update){
      callback = update;
    }
    return callback(new NeopreneError('Conditions, updates and callback are mandatory'))
  }
  options.update = update;
  this.findOne({ _id: id }, '', options, callback);
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="findByIdAndRemove">findByIdAndRemove</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.findByIdAndRemove()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{Number}</span><span class="name">id</span><span class="description">Id of node/relationship</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">update</span><span class="description">Object with fields and updates</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">options</span><span class="description">Object of options</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node,Relationship}</span><span class="description">Node/Relationship</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Finds and removes a single node which matches the id.<br />If multiple nodes match the first node will be returned and removed<br />Conditions and callback are mandatory but options is not</p>

<p>Examples:<br />User.findByIdAndRemove(20138, function(err, nodes){})</p>

<p>Options are used to force a delete. If a node has relationships you cannot delete it<br />Set options to force to remove all relationships as well<br />User.findByIdAndRemove(20138, {force: true}, function(){})</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.findByIdAndRemove = function(id, options, callback){
  if (1 === arguments.length &amp;&amp; 'function' == typeof id) {
    callback = id;
    return callback(new NeopreneError('You need to enter conditions to find the node'))
  }
  if(typeof options === ' function'){
    callback = options;
    options = {};
  }
  if(!options.remove) options.remove = true;
  this.findOne({ _id: id }, '', options, callback);
}</code></pre></div></div></div></article><article class="comment"><header><h1 id="getIndexedNode">getIndexedNode</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.getIndexedNode()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">index</span><span class="description"></span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">key</span><span class="description"></span></li><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">value</span><span class="description"></span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Node}</span><span class="description"></span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Return a single indexed node. Errors if more than one record<br />returned from the database</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.getIndexedNode = function(index, key, value, callback){
  this.base.getIndexedNode(index, key, value, callback);
};

// /**
//  * Return a single indexed relationship. Errors if more than one record
//  * returned from the database
//  * @param  {String}   index
//  * @param  {String}   key
//  * @param  {String}   value
//  * @param  {Function} callback
//  * @return {Node}
//  * @api public
//  */
// Model.getIndexedRelationship = function(index, key, value, callback){
//   this.base.getIndexedRelationship(index, key, value, callback);
// };</code></pre></div></div></div></article><article class="comment"><header><h1 id="query">query</h1><h5 class="subheader"><div class="label radius ctx-type">method</div>Model.query()</h5></header><ul class="no-bullet tags"><li class="tag"><span class="type">@param: </span><span class="types">{String}</span><span class="name">query</span><span class="description">Cypher query</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Object}</span><span class="name">params</span><span class="description">Name/Value pairs for the query</span></li><li class="tag"><span class="type">@param: </span><span class="types">{Function}</span><span class="name">callback</span><span class="description"></span></li><li class="tag"><span class="type">@return: </span><span class="types">{Array}</span><span class="description">Array of nodes/relationships or empty array</span></li></ul><div data-section="accordian" data-options="one_up: false;" class="section-container code auto"><div class="section"><p data-section-title class="title"><a href="#">Description</a></p><div data-section-content class="content description"><p>Run a query against the database. Use params to protect against injection</p></div></div><div class="section"><p data-section-title class="title"><a href="#">Source</a></p><div data-section-content class="content"><pre><code class="language-javascript">Model.query = function(query, params, callback){
  this.base.query(query, params, callback);
};

// /**
//  * Run a Lucene query against a relationship index. If no relationships exist
//  * an empty array is returned.
//  *
//  * NOTE: Neo4j currently uses Lucene 3.5
//  *
//  * @param  {String}   index
//  * @param  {String}   query    Stringified query e.g. name=John*&amp;age=20.
//  * @param  {Function} callback
//  * @return {Array}            The array of matched relationships or empty array.
//  * @api    public
//  */
// Model.queryRelationshipIndex = function(index, query, callback){
//   return this.base.queryIndex(index, query, 'relationship', callback);
// };

// /**
//  * Run a Lucene query against a node index. If no nodes exist
//  * an empty array is returned.
//  *
//  * NOTE: Neo4j currently uses Lucene 3.5
//  *
//  * @param  {String}   index
//  * @param  {String}   query    Stringified query e.g. name=John*&amp;age=20.
//  * @param  {Function} callback
//  * @return {Array}            The array of matched nodes or empty array.
//  * @api    public
//  */
// Model.queryNodeIndex = function(index, query, callback){
//   return this.base.queryIndex(index, query, 'node', callback);
// };

module.exports = Model;</code></pre></div></div></div></article></div></div><!-- Foundation JS--><script type="text/javascript">document.write('<script src=' +
('__proto__' in {} ? 'http://cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min' : 'http://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min') +
'.js><\/script>')
</script><script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.1.6/js/foundation.min.js"></script><script src="http://cdnjs.cloudflare.com/ajax/libs/foundation/4.1.6/js/foundation/foundation.reveal.min.js"></script><!-- Prism js--><script type="text/javascript">
/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 * MIT license http://www.opensource.org/licenses/mit-license.php/
 * @author Lea Verou http://lea.verou.me
 */(function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e){n.call(e,r,e[r]);t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;if(a){o=(a.className.match(e)||[,""])[1];u=t.languages[o]}if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o;a=r.parentNode;/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data),o);t.hooks.run("before-insert",l);l.element.innerHTML=l.highlightedCode;s&&s.call(l.element);t.hooks.run("after-highlight",l)};c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else{l.highlightedCode=t.highlight(l.code,l.grammar,l.language);t.hooks.run("before-insert",l);l.element.innerHTML=l.highlightedCode;s&&s.call(r);t.hooks.run("after-highlight",l)}},highlight:function(e,r,i){return n.stringify(t.tokenize(e,r),i)},tokenize:function(e,n,r){var i=t.Token,s=[e],o=n.rest;if(o){for(var u in o)n[u]=o[u];delete n.rest}e:for(var u in n){if(!n.hasOwnProperty(u)||!n[u])continue;var a=n[u],f=a.inside,l=!!a.lookbehind,c=0;a=a.pattern||a;for(var h=0;h<s.length;h++){var p=s[h];if(s.length>e.length)break e;if(p instanceof i)continue;a.lastIndex=0;var d=a.exec(p);if(d){l&&(c=d[1].length);var v=d.index-1+c,d=d[0].slice(c),m=d.length,g=v+m,y=p.slice(0,v+1),b=p.slice(g+1),w=[h,1];y&&w.push(y);var E=new i(u,f?t.tokenize(d,f):d);w.push(E);b&&w.push(b);Array.prototype.splice.apply(s,w)}}}return s},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[];r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e;this.content=t};n.stringify=function(e,r,i){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]")return e.map(function(t){return n.stringify(t,r,e)}).join("");var s={type:e.type,content:n.stringify(e.content,r,i),tag:"span",classes:["token",e.type],attributes:{},language:r,parent:i};s.type=="comment"&&(s.attributes.spellcheck="true");t.hooks.run("wrap",s);var o="";for(var u in s.attributes)o+=u+'="'+(s.attributes[u]||"")+'"';return"<"+s.tag+' class="'+s.classes.join(" ")+'" '+o+">"+s.content+"</"+s.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r])));self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1];if(r){t.filename=r.src;document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)}})();;
Prism.languages.markup={comment:/&lt;!--[\w\W]*?-->/g,prolog:/&lt;\?.+?\?>/,doctype:/&lt;!DOCTYPE.+?>/,cdata:/&lt;!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?>/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|>|"/g}},punctuation:/\/?>/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi};Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});;
Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*{))/gi,inside:{punctuation:/[;:]/g}},url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\};]*(?=\s*\{)/g,property:/(\b|\B)[\w-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g};Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}});;
Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|(^|[^:])\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,"function":{pattern:/[a-z0-9_]+\(/ig,inside:{punctuation:/\(/}}, number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,operator:/[-+]{1,2}|!|&lt;=?|>=?|={1,3}|(&amp;){1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g};;
Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|catch|finally|null|break|continue)\b/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g});Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}});Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}});;
Prism.languages.coffeescript=Prism.languages.extend("javascript",{"block-comment":/([#]{3}\s*\r?\n(.*\s*\r*\n*)\s*?\r?\n[#]{3})/g,comment:/(\s|^)([#]{1}[^#^\r^\n]{2,}?(\r?\n|$))/g,keyword:/\b(this|window|delete|class|extends|namespace|extend|ar|let|if|else|while|do|for|each|of|return|in|instanceof|new|with|typeof|try|catch|finally|null|undefined|break|continue)\b/g});Prism.languages.insertBefore("coffeescript","keyword",{"function":{pattern:/[a-z|A-z]+\s*[:|=]\s*(\([.|a-z\s|,|:|{|}|\"|\'|=]*\))?\s*-&gt;/gi,inside:{"function-name":/[_?a-z-|A-Z-]+(\s*[:|=])| @[_?$?a-z-|A-Z-]+(\s*)| /g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g}},"attr-name":/[_?a-z-|A-Z-]+(\s*:)| @[_?$?a-z-|A-Z-]+(\s*)| /g});;
Prism.languages.scss=Prism.languages.extend("css",{comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},atrule:/@[\w-]+(?=\s+(\(|\{|;))/gi,url:/([-a-z]+-)*url(?=\()/gi,selector:/([^@;\{\}\(\)]?([^@;\{\}\(\)]|&amp;|\#\{\$[-_\w]+\})+)(?=\s*\{(\}|\s|[^\}]+(:|\{)[^\}]+))/gm});Prism.languages.insertBefore("scss","atrule",{keyword:/@(if|else if|else|for|each|while|import|extend|debug|warn|mixin|include|function|return)|(?=@for\s+\$[-_\w]+\s)+from/i});Prism.languages.insertBefore("scss","property",{variable:/((\$[-_\w]+)|(#\{\$[-_\w]+\}))/i});Prism.languages.insertBefore("scss","ignore",{placeholder:/%[-_\w]+/i,statement:/\B!(default|optional)\b/gi,"boolean":/\b(true|false)\b/g,"null":/\b(null)\b/g,operator:/\s+([-+]{1,2}|={1,2}|!=|\|?\||\?|\*|\/|\%)\s+/g});
;
</script><script type="text/javascript">
  var headerHeight = 64;

  $(document).foundation();

  $(function(){
    $('pre').addClass('language-javascript');
  //   $('#nav > ul > li > a[href$="'+location.pathname.substring(location.pathname.lastIndexOf('/')+1, location.pathname.length)+'"]').parent().addClass('active');
  })</script></body></html>